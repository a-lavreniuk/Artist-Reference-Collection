---
alwaysApply: true
---
SYSTEM_CONTEXT:
- Проект: ARC — персональное офлайн настольное приложение для организации визуальных референсов дизайнеров
- Платформа: Windows 10/11 (настольное приложение)
- Технологии: Electron, Node.js, веб-технологии (HTML, CSS, JavaScript/TypeScript)
- Архитектура: Main Process + Renderer Process, IndexedDB для метаданных, Node.js File System API для файлов
- Цель: автономный, быстрый и надежный инструмент для каталогизации изображений и видео
- UI/UX: адаптирован под разрешение 1920×1080 — 2560×1440, изменяемый размер окна в этих границах
- Особенности: полностью офлайн, работа с локальной файловой системой, без интернет-зависимостей
- Требования: высокая производительность для больших коллекций (до 50,000 файлов), отзывчивая виртуализация UI
- Язык разработки: JavaScript/TypeScript с Node.js API
- Стиль кода: модульная архитектура с четким разделением ответственности между классами
- Стандарты: лучшие практики Electron, безопасное использование Node.js API в renderer, IPC коммуникация

ELECTRON_SPECIFIC:
- Main Process: управление окном приложения, автообновления через electron-updater, системные уведомления
- Renderer Process: UI логика, работа с IndexedDB через Dexie.js, Canvas API для превью
- IPC Communication: безопасная передача данных между main и renderer процессами
- File System: прямой доступ к файловой системе через Node.js fs API
- Security: отключить node integration в renderer, использовать contextIsolation и preload скрипты
- Packaging: готовность к сборке в исполняемый файл для Windows

CODING_RULES:
- Используй понятные названия классов и методов (например, DataManager, CardManager, FileManager)
- Создавай отдельные классы для каждой области ответственности (UI, данные, файлы, события)
- Пиши комментарии на русском, объясняя назначение методов и бизнес-логику
- Следуй принципам SOLID, особенно Single Responsibility Principle
- Обрабатывай все возможные ошибки файловой системы (try/catch, проверки доступности)
- Используй async/await для всех асинхронных операций (файлы, база данных)
- Применяй TypeScript типы для всех методов, интерфейсов и данных
- Оптимизируй производительность: виртуализация списков, ленивая загрузка, Web Workers для тяжелых операций
- Не блокируй UI долгими операциями, выносить в фоновые процессы

COMMUNICATION:
- НИКОГДА не использовать эмодзи в ответах, комментариях к коду, коммитах, релизах и любой документации
- Писать чистый текст без смайликов и эмоций
- Использовать профессиональный технический стиль

DATABASE_ARCHITECTURE:
- IndexedDB через библиотеку Dexie.js для метаданных карточек, тегов, коллекций
- Схема из 6 основных таблиц: cards, tags, categories, collections, moodboard, settings
- Индексирование полей для быстрого поиска и фильтрации
- Транзакционные операции для обеспечения консистентности данных
- Автоматическое обновление счетчиков использования через триггеры

FILE_SYSTEM_LOGIC:
- Структура файлов: рабочая_папка/{год}/{месяц}/{день}/ для оригиналов
- Превью: рабочая_папка/_cache/thumbs/ для миниатюр
- Canvas API для генерации превью изображений и видео
- Мониторинг доступности файлов и папок
- Резервное копирование в ZIP архивы через Node.js библиотеки

UI_PERFORMANCE:
- Виртуализация галереи карточек через react-window или аналоги
- Intersection Observer API для ленивой загрузки превью
- Масштабируемая masonry-сетка с кешированием размеров
- Debounce для поисковых запросов (300мс)
- Web Workers для фоновой обработки изображений и индексации

PROJECT_SPECIFIC:
- Размер окна изменяется в границах 1920×1080 — 2560×1440, система запоминает последний размер
- Скелетон-загрузчики (grayscale-100 фон, grayscale-200 border) вместо спиннеров
- Алгоритм поиска: полнотекстовый по названиям/заметкам + саджест с prefix-match
- Система событий между компонентами через EventEmitter
- Импорт файлов: объединенная технология drag-and-drop + file dialog
- Лимиты: максимум 50 файлов в одной операции импорта
- Горячие клавиши для основных действий (Ctrl+N, Ctrl+F, Del и т.д.)
- Макеты в Figma с точными размерами и отступами — строгое соблюдение дизайна
- Документация в Notion содержит полную архитектуру — изучать перед началом кодирования
- Приложение устанавливается и запускается как обычная Windows программа
- Автономная работа без интернета, все ресурсы локальные

ERROR_HANDLING:
- Централизованная система уведомлений об ошибках через toast или modal
- Graceful degradation при нехватке памяти или дискового пространства
- Валидация всех пользовательских вводов перед сохранением
- Логирование ошибок в локальные файлы для отладки
- Проверка целостности данных при старте приложения
- Обработка поврежденных медиафайлов с показом placeholder'ов